@using SPTarkov.Server.Core.Models.Eft.Profile

@inject I18NMgr I18NMgr

<MudCardContent Class="spt-info-mud-card-content">
    <MudText>@("webUI.titleCreateProfileSptVersion".Translate(I18NMgr.I18N!))</MudText>
    <MudText Class="two-char-indent" Typo="Typo.body2">Version: @SptProfile?.SptData?.Version</MudText>
    <MudText>@("webUI.historyLoadModInfo".Translate(I18NMgr.I18N!))</MudText>
    @{
        List<ModDetails> mods = SptProfile?.SptData?.Mods ?? [];
        IEnumerable<ModDetails> displayMods = _modInfoShowAll ? mods : mods.Take(5);
        foreach (ModDetails detail in displayMods)
        {
            <div style="display: flex">
                <MudText Class="two-char-indent">@("name".Translate(I18NMgr.I18N!)): @detail.Name</MudText>
                <MudText Class="two-char-indent">@("webUI.version".Translate(I18NMgr.I18N!)): @detail.Version</MudText>
                <MudText Class="two-char-indent">@("author".Translate(I18NMgr.I18N!)): @detail.Author</MudText>
                @if (!string.IsNullOrEmpty(detail.Url))
                {
                    <MudLink Class="two-char-indent" Href="@detail.Url" Target="_blank">@detail.Name</MudLink>
                }
            </div>
        }
    }
    <MudCardActions>
        <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="@(() => ToggleShowAll())">
            @_modInfoShowAllText
        </MudButton>
    </MudCardActions>
    <style>
        .two-char-indent {
            text-indent: 2ch;
        }

        .spt-info-mud-card-content {
            border: 2px solid #ccc;
        }
    </style>
</MudCardContent>

@code {
    [Parameter]
    public SptProfile? SptProfile { get; set; }

    private bool _modInfoShowAll;
    private string? _modInfoShowAllText;
    private string? _collapse;
    private string? _expand;

    private void ToggleShowAll()
    {
        _modInfoShowAll = !_modInfoShowAll;
        _modInfoShowAllText = _modInfoShowAll ? _collapse : _expand;
    }    
    
    protected override void OnInitialized()
    {
        base.OnInitialized();
        _collapse = "collapse".Translate(I18NMgr.I18N!);
        _expand = "expand".Translate(I18NMgr.I18N!);
        _modInfoShowAllText = _expand;
    }
}